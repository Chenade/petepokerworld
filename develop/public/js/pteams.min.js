$(document).ready(function() {

    var object = {};

    ajax('GET', '/api/n8/list', {}, function (a) {
        $('#events').empty();
        var list = a.data;
        for (var i in list) {
            if(list[i]['image'])
            {
                var news = list[i];
                object[news['id']] = news;
                var div = '' +
                        '<div class="col-12 col-sm-6 col-lg-4" style="padding: 25px;">' +
                            '<div class="service-box" style="box-shadow:-0.5px 2px 10px 1px rgba(56, 142, 144, 0.17);">' +
                                '<div class="post-thumbnail"><img src="/upload/Image/'+ news['image'] + '" alt="" ></div> ' +
                                '<div class="col-12" style="padding-left: 2em;">' +
                                    '<div class="service-tag-title">' + news['title'] + '</div>' +
                                    // '<div class="service-detail">' + news['content'].substring(2, 150) + '. . .</div>' +
                                '<button class="btn-pete col-12 detail" data-id="' + news['id'] + '" style="text-align:right!important;">查看更多 <i class="fas fa-long-arrow-alt-right"></i></button>' +
                                '</div>\n' +
                            '</div>' +
                        '</div>';
                $('#events').append(div);
            }
        }
    })

    $(document).on('click', '.detail', function () {
        let tid = $(this).data('id'), _this = object[tid];
        console.log(tid, _this);

        $('.modal-title').text(_this.title);
        $('#des').html(_this.content.substring(1, _this.content.length-2));
        $('#updated_at').text(_this.updated_at);
        $('#created_at').text(_this.created_at);

        let response = '';
        // _this.image.forEach(el => {
            response += '<div class="parent">';
            response += '<img class="owl-img" src="/upload/Image/' + _this.image + '" >';
            response += '</div>';
        // });
        $('#img-box').html(response);

        $('#n8_modal').modal({
            backdrop: 'static',
            keyboard: true,
            show: true
        });
    });

 });