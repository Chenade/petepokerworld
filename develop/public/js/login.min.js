$(document).ready(function () {
    var id = "", isfaEnable = $('#is2fa').data('enable'), isrecaptcha = $('#isRecaptcha').data('enable');
    var login = function () {
        // window.localStorage['uuid'] || guid();
        var btn = $('#login');
        // btn.button('loading');
        var data = {
            'account': $('#user').val(),
            'password': $('#password').val(),
        };

        ajax('POST', '/api/admin/login', data, function (a) {
            console.log(a);
            // btn.button('reset');
            if(a.success){
                document.cookie = "Authorization="+a.token;
                window.location.replace('/admin');
            }else
                $.growl.error({message: a.message})
        });
    };

    $('#language').val($('[name="_lang"]').attr('content')).selectpicker('refresh');
    $('#login').on('click', function () {
        // window.localStorage['uuid'] || guid();
        var btn = $('#login');
        // btn.button('loading');
        var data = {
            'account': $('#user').val(),
            'password': $('#password').val(),
        };

        ajax('POST', '/api/admin/login', data, function (a) {
            console.log(a);
            // btn.button('reset');
            if(a.success){
                document.cookie = "Authorization="+a.message;
                window.location.href = '/admin';
            }else
                $.growl.error({message: a.message})
        });
    });

    $("#password").keypress(function( event ) {
        if(event.key === "Enter") $('#login').click();
    });
    $('#language').on("change", function () {
        window.location.href = '/language/' + $(this).val();
    });


    $('#newPassword-modal').on('hidden.bs.modal', function (e) {
        userLog();
    });
});